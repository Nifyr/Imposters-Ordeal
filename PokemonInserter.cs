using AssetsTools.NET;
using AssetsTools.NET.Extra;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Windows.Forms;
using static ImpostersOrdeal.GameDataTypes;
using static ImpostersOrdeal.GlobalData;
using static ImpostersOrdeal.Wwise;
using SmartPoint.AssetAssistant;
using System.Text.RegularExpressions;
using static Mono.CompilerServices.SymbolWriter.CodeBlockEntry;
using System.Xml.Linq;
using SmartPoint.AssetAssistant.UnityExtensions;

namespace ImpostersOrdeal
{
    class PokemonInserter
    {
        enum AssetClassID
        {
            GameObject = 1,
            Material = 21,
            Texture2D = 28,
            Mesh = 43,
            AnimationClip = 74,
            AssetBundle = 142,
        }

        private static PokemonInserter instance;
        private readonly Random rnd;
        private readonly Dictionary<string, string> CABNames;
        private readonly byte[] imageData = {
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 24, 129, 0, 0, 128, 59, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0,
20, 137, 27, 1, 32, 136, 247, 171, 98, 248, 85, 179, 0, 0, 0, 0, 45, 10, 17, 1, 32, 200, 83, 51, 248, 42, 20, 59, 2, 4, 0, 0,
45, 10, 17, 1, 0, 152, 247, 59, 72, 107, 0, 92, 1, 0, 0, 0, 79, 136, 16, 49, 113, 3, 0, 26, 40, 57, 45, 18, 225, 2, 0, 0,
93, 80, 9, 1, 99, 7, 32, 208, 251, 70, 1, 65, 24, 192, 0, 0, 45, 138, 135, 2, 16, 128, 94, 144, 128, 180, 170, 0, 0, 0, 0, 0,
8, 129, 0, 6, 0, 148, 1, 0, 4, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
98, 73, 14, 1, 3, 12, 0, 0, 52, 0, 2, 0, 0, 0, 0, 0, 8, 73, 28, 1, 192, 201, 134, 255, 251, 47, 47, 59, 4, 46, 176, 0,
20, 1, 247, 104, 154, 80, 104, 141, 64, 127, 127, 127, 127, 127, 127, 63, 111, 192, 130, 73, 203, 145, 221, 0, 0, 0, 0, 0, 0, 0, 0, 0,
111, 0, 127, 227, 168, 88, 73, 109, 0, 0, 0, 0, 0, 0, 0, 0, 111, 0, 123, 111, 168, 84, 229, 111, 0, 0, 0, 0, 0, 0, 0, 0,
111, 192, 68, 21, 129, 213, 37, 196, 148, 148, 146, 82, 82, 74, 218, 71, 77, 194, 94, 119, 195, 182, 54, 219, 108, 179, 205, 54, 155, 108, 3, 137,
8, 73, 1, 145, 108, 0, 28, 16, 15, 241, 224, 13, 236, 64, 4, 16, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
81, 131, 128, 1, 248, 5, 0, 128, 2, 0, 128, 6, 0, 160, 6, 0, 115, 193, 114, 237, 194, 191, 10, 95, 91, 180, 109, 221, 182, 109, 219, 182,
111, 0, 127, 227, 168, 88, 73, 73, 41, 41, 165, 165, 133, 14, 8, 0, 111, 192, 144, 109, 231, 195, 73, 73, 41, 41, 37, 165, 164, 148, 148, 26,
111, 192, 146, 111, 233, 255, 1, 0, 0, 0, 0, 0, 0, 0, 0, 128, 111, 192, 148, 113, 235, 253, 1, 0, 0, 0, 0, 0, 0, 0, 208, 0,
111, 192, 146, 109, 231, 111, 73, 73, 41, 41, 37, 165, 164, 151, 68, 242, 125, 72, 14, 65, 72, 236, 95, 94, 121, 144, 92, 113, 92, 109, 173, 173,
97, 153, 152, 156, 56, 0, 232, 187, 19, 136, 98, 128, 0, 0, 140, 96, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 20, 233, 23, 1, 32, 204, 211, 146, 99, 3, 249, 242, 112, 87, 246, 187,
252, 253, 255, 255, 255, 255, 255, 255, 200, 200, 182, 182, 243, 243, 255, 255, 252, 253, 255, 255, 255, 255, 255, 255, 200, 200, 182, 182, 243, 243, 255, 255,
252, 253, 255, 255, 255, 255, 255, 255, 200, 200, 182, 182, 243, 243, 255, 255, 252, 253, 255, 255, 255, 255, 255, 255, 200, 200, 182, 182, 243, 243, 255, 255,
252, 253, 255, 255, 255, 255, 255, 255, 200, 200, 182, 182, 243, 243, 255, 255, 67, 9, 3, 1, 2, 158, 213, 1, 185, 47, 221, 167, 40, 150, 90, 147,
97, 129, 2, 0, 0, 228, 0, 0, 0, 0, 0, 0, 128, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 67, 137, 3, 1, 0, 158, 247, 7, 169, 7, 148, 1, 132, 3, 204, 0,
111, 192, 146, 111, 233, 227, 72, 73, 45, 9, 37, 165, 164, 148, 148, 146, 8, 1, 219, 152, 111, 141, 85, 127, 255, 255, 255, 123, 66, 216, 255, 255,
31, 106, 25, 113, 204, 128, 91, 66, 138, 153, 38, 15, 60, 39, 248, 123, 110, 200, 60, 113, 182, 52, 91, 194, 88, 69, 149, 85, 85, 255, 66, 253,
111, 192, 148, 113, 235, 253, 205, 0, 0, 0, 0, 0, 0, 0, 0, 0, 82, 73, 8, 172, 188, 5, 220, 45, 42, 28, 62, 159, 207, 227, 75, 121,
115, 129, 64, 0, 31, 0, 160, 0, 192, 3, 128, 15, 0, 60, 0, 96, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 81, 69, 215, 25, 1, 20, 118, 191, 70, 127, 14, 114, 199, 80, 252, 0,
99, 193, 166, 129, 255, 119, 45, 108, 61, 61, 183, 247, 246, 222, 222, 219, 82, 169, 54, 11, 213, 180, 147, 215, 133, 124, 63, 127, 167, 192, 170, 177,
111, 32, 175, 238, 218, 240, 233, 237, 189, 189, 183, 17, 11, 0, 96, 0, 113, 105, 33, 235, 85, 239, 121, 103, 71, 131, 112, 184, 248, 0, 0, 0,
8, 41, 45, 177, 181, 16, 28, 0, 14, 248, 224, 215, 211, 111, 255, 255, 8, 105, 21, 1, 192, 91, 135, 0, 0, 0, 0, 0, 90, 244, 48, 253,
111, 128, 2, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 20, 209, 44, 193, 126, 0, 24, 128, 67, 6, 200, 242, 112, 84, 246, 59,
8, 73, 28, 209, 126, 0, 24, 0, 4, 248, 192, 36, 209, 131, 175, 246, 20, 41, 87, 5, 0, 217, 12, 86, 32, 0, 200, 12, 112, 81, 121, 127,
8, 41, 45, 209, 126, 0, 28, 0, 0, 224, 64, 131, 211, 79, 111, 255, 226, 144, 49, 1, 0, 242, 27, 2, 44, 8, 0, 0, 128, 194, 63, 126,
8, 129, 0, 6, 0, 182, 1, 0, 0, 0, 0, 0, 0, 0, 0, 64, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0,
252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 252, 253, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0 };

        private PokemonInserter()
        {
            rnd = new();
            CABNames = new();
        }
        public static PokemonInserter GetInstance()
        {
            instance ??= new();
            return instance;
        }
        public string GenCABName()
        {
            string[] values = new string[4];
            for (int i = 0; i < values.Length; i++)
            {
                values[i] = rnd.Next().ToString("x8");
            }

            return string.Join("", values);
        }

        public int GenUniqueID(int monsNo, int formNo, int gender, bool isRare)
        {
            return monsNo * 10000 + formNo * 100 + gender * 10 + (isRare ? 1 : 0);
        }

        public void InsertPokemon(int srcMonsNo, int dstMonsNo, int srcFormNo, int dstFormNo, string speciesName, string formName)
        {
            List<(int, int)> uniqueIDs = GetUniqueIDs(srcMonsNo, dstMonsNo, srcFormNo, dstFormNo);
            UpdatePokemonInfo(uniqueIDs, out List<(string, string)> assetBundleNames);
            UpdateUIMasterdatas(uniqueIDs,
                out Dictionary<string, string> menuSprites,
                out Dictionary<string, string> largeSprites,
                out Dictionary<string, string> dpSprites);
            UpdateDprBin(assetBundleNames, largeSprites, dpSprites, out Dictionary<string, string> assetBundlePaths);
            UpdateAudioBank(uniqueIDs, out (uint, uint) sourceID);

            UpdateAddPersonalTable(srcMonsNo, dstMonsNo, srcFormNo, dstFormNo);
            UpdateMotionTimingData(uniqueIDs);
            UpdatePersonalInfos(srcMonsNo, dstMonsNo, srcFormNo, dstFormNo, speciesName);
            UpdateCommonMsbt(srcMonsNo, dstMonsNo, srcFormNo, dstFormNo, speciesName, formName);
            DuplicateIcons(menuSprites, largeSprites, dpSprites);
            DuplicateAudioSource(sourceID.Item1, sourceID.Item2);
            DuplicateAssetBundles(assetBundlePaths);
            gameData.SetModified(GameDataSet.DataField.UIMasterdatas);
            gameData.SetModified(GameDataSet.DataField.AddPersonalTable);
            gameData.SetModified(GameDataSet.DataField.MotionTimingData);
            gameData.SetModified(GameDataSet.DataField.PokemonInfo);
            gameData.SetModified(GameDataSet.DataField.MessageFileSets);
            gameData.SetModified(GameDataSet.DataField.PersonalEntries);
            gameData.SetModified(GameDataSet.DataField.DprBin);
            gameData.SetModified(GameDataSet.DataField.AudioData);
        }

        private void DuplicateIcons(Dictionary<string, string> menuSprites, Dictionary<string, string> largeSprites, Dictionary<string, string> dpSprites)
        {
            foreach (KeyValuePair<string, string> pair in largeSprites)
                fileManager.DuplicateIconBundle("textures_mass\\pokemon_l\\" + pair.Key, "textures_mass\\pokemon_l\\" + pair.Value);
            foreach (KeyValuePair<string, string> pair in dpSprites)
                fileManager.DuplicateIconBundle("textures_mass\\pokemon_dp\\" + pair.Key, "textures_mass\\pokemon_dp\\" + pair.Value);

            AssetsManager am = fileManager.GetAssetsManager();
            BundleFileInstance bfi = fileManager.GetTexturemassBundle();
            AssetsFileInstance afi = am.LoadAssetsFileFromBundle(bfi, 0);
            TypeTree tt = afi.file.typeTree;
            Type_0D t0D = AssetHelper.FindTypeTreeTypeByID(tt, 28);
            AssetTypeTemplateField attf = new();
            attf.From0D(t0D, 0);

            AssetFileInfoEx afie = afi.table.GetAssetsOfType(687078895).First();
            AssetTypeValueField spriteAtlas = am.GetTypeInstance(afi, afie).GetBaseField();
            AssetTypeTemplateField spriteATTF = spriteAtlas["m_PackedSprites"]["Array"][0].GetTemplateField();
            List<AssetTypeValueField> spriteATVFs = spriteAtlas["m_PackedSprites"]["Array"].GetChildrenList().ToList();
            AssetTypeTemplateField spriteNameATTF = spriteAtlas["m_PackedSpriteNamesToIndex"]["Array"][0].GetTemplateField();
            List<AssetTypeValueField> spriteNameATVFs = spriteAtlas["m_PackedSpriteNamesToIndex"]["Array"].GetChildrenList().ToList();
            AssetTypeTemplateField renderDataPairATTF = spriteAtlas["m_RenderDataMap"]["Array"][0].GetTemplateField();
            List<AssetTypeValueField> renderDataPairATVFs = spriteAtlas["m_RenderDataMap"]["Array"].GetChildrenList().ToList();
            List<AssetsReplacer> ars = new();
            foreach (KeyValuePair<string, string> pair in menuSprites)
            {
                AssetTypeValueField texture2DATVF = ValueBuilder.DefaultValueFieldFromTemplate(attf);
                FillTexture2D(texture2DATVF);
                texture2DATVF["m_Name"].GetValue().Set(pair.Value + "_Texture2D");
                long texture2DPathID = afi.table.assetFileInfo.Max(afie => afie.index) + 1;
                ars.Add(new AssetsReplacerFromMemory(0, texture2DPathID, 28, 0xFFFF, texture2DATVF.WriteToByteArray()));

                AssetTypeValueField spriteATVF = afi.table.GetAssetsOfType(213)
                    .Select(afie => am.GetTypeInstance(afi, afie).GetBaseField())
                    .First(a => a["m_Name"].value.AsString() == pair.Key);
                spriteATVF["m_Name"].GetValue().Set(pair.Value);
                spriteATVF["m_Rect"]["x"].GetValue().Set(0);
                spriteATVF["m_Rect"]["y"].GetValue().Set(0);
                spriteATVF["m_Rect"]["width"].GetValue().Set(128);
                spriteATVF["m_Rect"]["height"].GetValue().Set(128);
                spriteATVF["m_Offset"]["x"].GetValue().Set(0);
                spriteATVF["m_Offset"]["y"].GetValue().Set(0);
                uint[] renderDataKey = new uint[4];
                for (int i = 0; i < renderDataKey.Length; i++)
                    renderDataKey[i] = NextUInt32();
                spriteATVF["m_RenderDataKey"]["first"]["data[0]"].GetValue().Set(renderDataKey[0]);
                spriteATVF["m_RenderDataKey"]["first"]["data[1]"].GetValue().Set(renderDataKey[1]);
                spriteATVF["m_RenderDataKey"]["first"]["data[2]"].GetValue().Set(renderDataKey[2]);
                spriteATVF["m_RenderDataKey"]["first"]["data[3]"].GetValue().Set(renderDataKey[3]);
                spriteATVF["m_RD"]["textureRect"]["x"].GetValue().Set(0);
                spriteATVF["m_RD"]["textureRect"]["y"].GetValue().Set(0);
                spriteATVF["m_RD"]["textureRect"]["width"].GetValue().Set(128);
                spriteATVF["m_RD"]["textureRect"]["height"].GetValue().Set(128);
                spriteATVF["m_RD"]["textureRectOffset"]["x"].GetValue().Set(0);
                spriteATVF["m_RD"]["textureRectOffset"]["y"].GetValue().Set(0);
                long spritePathID = afi.table.assetFileInfo.Max(afie => afie.index) + 2;
                ars.Add(new AssetsReplacerFromMemory(0, spritePathID, 213, 0xFFFF, spriteATVF.WriteToByteArray()));

                AssetTypeValueField atlasSprite = ValueBuilder.DefaultValueFieldFromTemplate(spriteATTF);
                atlasSprite["m_FileID"].GetValue().Set(0);
                atlasSprite["m_PathID"].GetValue().Set(spritePathID);
                spriteATVFs.Add(atlasSprite);

                AssetTypeValueField spriteName = ValueBuilder.DefaultValueFieldFromTemplate(spriteNameATTF);
                spriteName.GetValue().Set(pair.Value);
                spriteNameATVFs.Add(spriteName);

                AssetTypeValueField renderDataPair = ValueBuilder.DefaultValueFieldFromTemplate(renderDataPairATTF);
                renderDataPair["first"]["first"]["data[0]"].GetValue().Set(renderDataKey[0]);
                renderDataPair["first"]["first"]["data[1]"].GetValue().Set(renderDataKey[1]);
                renderDataPair["first"]["first"]["data[2]"].GetValue().Set(renderDataKey[2]);
                renderDataPair["first"]["first"]["data[3]"].GetValue().Set(renderDataKey[3]);
                renderDataPair["first"]["second"].GetValue().Set(21300000);
                renderDataPair["second"]["texture"]["m_PathID"].GetValue().Set(texture2DPathID);
                renderDataPair["second"]["textureRect"]["x"].GetValue().Set(0);
                renderDataPair["second"]["textureRect"]["y"].GetValue().Set(0);
                renderDataPair["second"]["textureRect"]["width"].GetValue().Set(128);
                renderDataPair["second"]["textureRect"]["height"].GetValue().Set(128);
                renderDataPair["second"]["textureRectOffset"]["x"].GetValue().Set(0);
                renderDataPair["second"]["textureRectOffset"]["y"].GetValue().Set(0);
                renderDataPair["second"]["atlasRectOffset"]["x"].GetValue().Set(0);
                renderDataPair["second"]["atlasRectOffset"]["y"].GetValue().Set(0);
                renderDataPair["second"]["uvTransform"]["x"].GetValue().Set(100);
                renderDataPair["second"]["uvTransform"]["y"].GetValue().Set(1000);
                renderDataPair["second"]["uvTransform"]["z"].GetValue().Set(100);
                renderDataPair["second"]["uvTransform"]["w"].GetValue().Set(1000);
                renderDataPair["second"]["downscaleMultiplier"].GetValue().Set(1);
                renderDataPair["second"]["settingsRaw"].GetValue().Set(67);
                renderDataPairATVFs.Add(renderDataPair);
            }

            spriteAtlas["m_PackedSprites"]["Array"].SetChildrenList(spriteATVFs.ToArray());
            spriteAtlas["m_PackedSpriteNamesToIndex"]["Array"].SetChildrenList(spriteNameATVFs.ToArray());
            spriteAtlas["m_RenderDataMap"]["Array"].SetChildrenList(renderDataPairATVFs.ToArray());
            AssetsReplacerFromMemory arfm = new(0, afie.index, (int)afie.curFileType, 0xFFFF, spriteAtlas.WriteToByteArray());
            ars.Add(arfm);

            fileManager.WriteTexturemassBundle(ars);
        }

        private void FillTexture2D(AssetTypeValueField atvf)
        {
            atvf["m_ForcedFallbackFormat"].GetValue().Set(4);
            atvf["m_Width"].GetValue().Set(128);
            atvf["m_Height"].GetValue().Set(128);
            atvf["m_CompleteImageSize"].GetValue().Set(7744);
            atvf["m_TextureFormat"].GetValue().Set(50);
            atvf["m_MipCount"].GetValue().Set(1);
            atvf["m_ImageCount"].GetValue().Set(1);
            atvf["m_TextureDimension"].GetValue().Set(2);
            atvf["m_TextureSettings"]["m_FilterMode"].GetValue().Set(1);
            atvf["m_TextureSettings"]["m_Aniso"].GetValue().Set(1);
            atvf["m_TextureSettings"]["m_WrapU"].GetValue().Set(1);
            atvf["m_TextureSettings"]["m_WrapV"].GetValue().Set(1);
            atvf["m_TextureSettings"]["m_WrapW"].GetValue().Set(1);
            atvf["m_ColorSpace"].GetValue().Set(1);
            atvf["image data"].GetValue().type = EnumValueTypes.ByteArray;
            atvf["image data"].templateField.valueType = EnumValueTypes.ByteArray;
            AssetTypeByteArray atba = new()
            {
                size = (uint)imageData.Length,
                data = imageData
            };
            atvf["image data"].GetValue().Set(atba);
            atvf["m_StreamData"]["path"].GetValue().Set("");
        }

        private long NextInt64()
        {
            long output;
            byte[] uintBytes = new byte[8];
            rnd.NextBytes(uintBytes);
            output = BitConverter.ToInt64(uintBytes);
            return output;
        }

        private static void DuplicateAudioSource(uint srcID, uint dstID)
        {
            if (srcID != 0 && dstID != 0)
                fileManager.DuplicateAudioSource(srcID, dstID);
        }

        private void UpdateAudioBank(List<(int, int)> uniqueIDs, out (uint, uint) sourceID)
        {
            (int, int) uniqueID = uniqueIDs.First();
            Dictionary<uint, WwiseObject> lookup = gameData.audioData.objectsByID;
            HircChunk hc = (HircChunk)gameData.audioData.banks.First().chunks.Find(c => c is HircChunk);

            lookup.TryGetValue(FNV132(GetWwiseEvents(uniqueID.Item1).First()), out WwiseObject wo);
            if (wo == null)
            {
                sourceID = (0, 0);
                return;
            }
            Event e = (Event)wo;
            ActionPlay ap = (ActionPlay)lookup[e.actionIDs.First()];
            lookup.TryGetValue(ap.idExt, out WwiseObject wo1);
            if (wo1 == null)
            {
                sourceID = (0, 0);
                return;
            }
            Sound s;
            if (wo1 is Sound s0)
                s = s0;
            else
            {
                SwitchCntr sc = (SwitchCntr)wo1;
                s = (Sound)lookup[sc.children.childIDs.First()];
            }
            sourceID = (s.bankSourceData.mediaInformation.sourceID, NextUInt32(gameData.audioData));

            Sound newS = (Sound)s.Clone();
            newS.id = NextUInt32(gameData.audioData);
            newS.nodeBaseParams.directParentID = NextUInt32(gameData.audioData);
            newS.bankSourceData.mediaInformation.sourceID = sourceID.Item2;
            gameData.audioData.objectsByID[newS.id] = newS;
            hc.loadedItem.Add(newS);

            if (uniqueID.Item1 / 10000 != 25 && uniqueID.Item1 / 10000 != 133)
            {
                ActorMixer am = (ActorMixer)lookup[s.nodeBaseParams.directParentID];
                ActorMixer amParent = (ActorMixer)lookup[am.nodeBaseParams.directParentID];
                ActorMixer newAM = (ActorMixer)am.Clone();
                newAM.id = newS.nodeBaseParams.directParentID;
                newAM.children.childIDs = new() { newS.id };
                amParent.children.childIDs.Add(newAM.id);
                gameData.audioData.objectsByID[newAM.id] = newAM;
                hc.loadedItem.Add(newAM);
            }
            else
                newS.nodeBaseParams.directParentID = 0;

            ActionPlay newAP = (ActionPlay)ap.Clone();
            newAP.id = NextUInt32(gameData.audioData);
            newAP.idExt = newS.id;
            gameData.audioData.objectsByID[newAP.id] = newAP;
            hc.loadedItem.Add(newAP);

            List<string> eventNames = GetWwiseEvents(uniqueID.Item2);
            List<uint> newEventIDs = eventNames.Select(s => FNV132(s)).ToList();
            foreach (uint newEventID in newEventIDs)
            {
                Event newE = (Event)e.Clone();
                newE.id = newEventID;
                newE.actionIDs = new();
                newE.actionIDs.Add(newAP.id);
                if (gameData.audioData.objectsByID.ContainsKey(newEventID))
                    hc.loadedItem.Remove((HircItem)gameData.audioData.objectsByID[newEventID]);
                gameData.audioData.objectsByID[newEventID] = newE;
                hc.loadedItem.Add(newE);
            }
            gameData.audioSourceLog ??= fileManager.GetAudioSourceLog();
            gameData.audioSourceLog.Append(eventNames[0] + " → " + sourceID.Item2 + "\n");
        }

        private uint NextUInt32(WwiseData wd)
        {
            uint output;
            do
            {
                byte[] uintBytes = new byte[4];
                rnd.NextBytes(uintBytes);
                output = BitConverter.ToUInt32(uintBytes);
            } while (wd.objectsByID.ContainsKey(output));
            return output;
        }

        private uint NextUInt32()
        {
            uint output;
            byte[] uintBytes = new byte[4];
            rnd.NextBytes(uintBytes);
            output = BitConverter.ToUInt32(uintBytes);
            return output;
        }

        private List<(int, int)> GetUniqueIDs(int srcMonsNo, int dstMonsNo, int srcFormNo, int dstFormNo)
        {
            (int, int) uniqueIDRange = (GenUniqueID(srcMonsNo, srcFormNo, 0, false), GenUniqueID(srcMonsNo, srcFormNo, 9, true));
            List<Masterdatas.PokemonInfoCatalog> pics = gameData.pokemonInfos.Where(pic => pic.UniqueID >= uniqueIDRange.Item1 && pic.UniqueID <= uniqueIDRange.Item2).ToList();
            List<(int, int)> uniqueIDPairs = new();
            foreach (Masterdatas.PokemonInfoCatalog pic in pics)
                uniqueIDPairs.Add((pic.UniqueID, GenUniqueID(dstMonsNo, dstFormNo, pic.Sex, pic.Rare)));
            return uniqueIDPairs;
        }

        public void UpdateDprBin(List<(string, string)> assetBundleNames, Dictionary<string, string> largeSprites, Dictionary<string, string> dpSprites,
            out Dictionary<string, string> assetBundlePaths)
        {
            AssetBundleDownloadManifest abdm = gameData.dprBin;

            assetBundlePaths = new();
            Dictionary<string, string> assetBundlePathsWithDependencies = new();

            List<AssetBundleRecord> recordsToClone = new();
            foreach ((string, string) assetBundleNamePair in assetBundleNames)
            {
                List<AssetBundleRecord> recordsToAdd = abdm.GetAssetBundleRecordsWithDependencies("pokemons/battle/" + assetBundleNamePair.Item1, true).ToList();
                recordsToAdd.AddRange(abdm.GetAssetBundleRecordsWithDependencies("pokemons/field/" + assetBundleNamePair.Item1, true));
                foreach (AssetBundleRecord record in recordsToAdd)
                    if (record.projectName == "Pokemon Database" &&
                        !assetBundlePaths.ContainsKey(record.assetBundleName) &&
                        !assetBundlePathsWithDependencies.ContainsKey(record.assetBundleName))
                    {
                        recordsToClone.Add(record);
                        string newAssetBundlePath = Path.Combine(Path.GetDirectoryName(record.assetBundleName),
                            GenAssetBundleName(assetBundleNamePair.Item2, Path.GetFileName(record.assetBundleName).Length)).Replace('\\', '/');

                        while (assetBundlePaths.Values.Contains(newAssetBundlePath) || assetBundlePathsWithDependencies.Values.Contains(newAssetBundlePath) ||
                            assetBundlePaths.Keys.Contains(newAssetBundlePath) || assetBundlePathsWithDependencies.Keys.Contains(newAssetBundlePath))
                            newAssetBundlePath = Path.Combine(Path.GetDirectoryName(record.assetBundleName),
                                GenAssetBundleName(int.Parse(assetBundleNamePair.Item2.Replace("pm", "").Replace("_", "")) + 2,
                                Path.GetFileName(record.assetBundleName).Length)).Replace('\\', '/');


                        if (record.allDependencies.Length == 0)
                            assetBundlePaths[record.assetBundleName] = newAssetBundlePath;
                        else
                            assetBundlePathsWithDependencies[record.assetBundleName] = newAssetBundlePath;
                    }
            }
            recordsToClone.Sort((r1, r2) => r1.allDependencies.Length - r2.allDependencies.Length);
            foreach (KeyValuePair<string, string> pair in assetBundlePathsWithDependencies)
                assetBundlePaths.Add(pair.Key, pair.Value);

            foreach (AssetBundleRecord record in recordsToClone)
            {
                AssetBundleRecord newRecord = (AssetBundleRecord)record.Clone();
                newRecord.assetBundleName = assetBundlePaths[newRecord.assetBundleName];

                for (int i = 0; i < newRecord.assetPaths.Length; i++)
                    newRecord.assetPaths[i] = ReplacePM(newRecord.assetPaths[i], Path.GetFileName(newRecord.assetBundleName));

                // What a surprise, gender variations in the same bundle! (sometimes)
                // Let's just get rid of the duplicates. Probably didn't need them anyway...
                newRecord.assetPaths = newRecord.assetPaths.Distinct().ToArray();

                for (int i = 0; i < newRecord.allDependencies.Length; i++)
                    if (assetBundlePaths.ContainsKey(newRecord.allDependencies[i]))
                        newRecord.allDependencies[i] = assetBundlePaths[newRecord.allDependencies[i]];

                abdm.Add(newRecord);
            }

            string lPath = "textures_mass/pokemon_l/";
            string dpPath = "textures_mass/pokemon_dp/";
            CloneAndAdd(abdm, largeSprites, lPath);
            CloneAndAdd(abdm, dpSprites, dpPath);
        }

        private static void CloneAndAdd(AssetBundleDownloadManifest abdm, Dictionary<string, string> fileNames, string path)
        {
            foreach (KeyValuePair<string, string> pair in fileNames)
            {
                AssetBundleRecord r = (AssetBundleRecord)abdm[path + pair.Key].Clone();
                r.assetBundleName = r.assetBundleName.Replace(pair.Key, pair.Value);
                for (int i = 0; i < r.assetPaths.Length; i++)
                    r.assetPaths[i] = r.assetPaths[i].Replace(pair.Key, pair.Value);
                for (int i = 0; i < r.allDependencies.Length; i++)
                    r.allDependencies[i] = r.allDependencies[i].Replace(pair.Key, pair.Value);
                abdm.Add(r);
            }
        }

        private string ReplacePM(string target, string reference)
        {
            string name6 = reference[..6];
            string name9 = reference[..9];
            string name12 = null;
            if (reference.Length >= 12)
                name12 = reference[..12];
            target = Regex.Replace(target, @"pm\d{4}", name6);
            target = Regex.Replace(target, @"pm\d{4}_\d{2}", name9);
            if (name12 != null)
                target = Regex.Replace(target, @"pm\d{4}_\d{2}_\d{2}", name12);
            return target;
        }

        public void UpdatePersonalInfos(int srcMonsNo, int dstMonsNo, int srcFormNo, int dstFormNo, string speciesName)
        {
            Pokemon srcPokemon = null;
            foreach (Pokemon pokemon in gameData.personalEntries)
            {
                if (pokemon.dexID == srcMonsNo && pokemon.formID == srcFormNo)
                {
                    srcPokemon = pokemon;
                }
                pokemon.pastPokemon = new();
                pokemon.nextPokemon = new();
                pokemon.inferiorForms = new();
                pokemon.superiorForms = new();
            }

            Pokemon newPokemon = (Pokemon)srcPokemon.Clone();
            newPokemon.dexID = (ushort) dstMonsNo;
            newPokemon.formID = dstFormNo;
            newPokemon.personalID = (ushort)GetPersonalInsertPos(newPokemon);

            PersonalInsert(newPokemon);
            if (gameData.dexEntries.Count == newPokemon.dexID)
            {
                newPokemon.name = speciesName;
                gameData.dexEntries.Add(new());
                gameData.dexEntries[newPokemon.dexID].dexID = newPokemon.dexID;
                gameData.dexEntries[newPokemon.dexID].forms = new();
                gameData.dexEntries[newPokemon.dexID].name = newPokemon.name;
            }
            gameData.dexEntries[newPokemon.dexID].forms.Add(newPokemon);
            foreach (Pokemon p in gameData.dexEntries[newPokemon.dexID].forms)
            {
                p.formMax = (byte)(dstFormNo + 1);
                if (gameData.dexEntries[newPokemon.dexID].forms.Count > 1)
                    p.formIndex = gameData.dexEntries[newPokemon.dexID].forms[1].personalID;
            }
            DataParser.SetFamilies();
        }

        private static void PersonalInsert(Pokemon insert)
        {
            foreach (Pokemon p in gameData.personalEntries)
            {
                if (p.personalID >= insert.personalID)
                    p.personalID++;
                if (p.formIndex >= insert.personalID)
                    p.formIndex++;
            }

            IEnumerable<LabelData> lds = gameData.messageFileSets.SelectMany(mfs => mfs.messageFiles.Where
            (mf => mf.mName.Contains("ss_zkn_form") || mf.mName.Contains("ss_zkn_height") || mf.mName.Contains("ss_zkn_weight"))
            .SelectMany(mf => mf.labelDatas));
            foreach (LabelData ld in lds)
            {
                if (ld.labelIndex >= insert.personalID)
                    ld.labelIndex++;
                if (ld.arrayIndex >= insert.personalID)
                    ld.arrayIndex++;
            }

            if (insert.personalID == gameData.personalEntries.Count)
                gameData.personalEntries.Add(insert);
            else
                gameData.personalEntries.Insert(insert.personalID, insert);
        }

        private static int GetPersonalInsertPos(Pokemon p)
        {
            for (int i = 0; i < gameData.personalEntries.Count; i++)
                if (p.CompareTo(gameData.personalEntries[i]) < 0)
                    return i;
            return gameData.personalEntries.Count;
        }

        public void UpdateCommonMsbt(int srcMonsNo, int dstMonsNo, int srcFormNo, int dstFormNo, string speciesName, string formName)
        {
            bool newSpecies = dstFormNo == 0;
            foreach (MessageFileSet msgFileSet in gameData.messageFileSets)
            {
                foreach (MessageFile msgFile in msgFileSet.messageFiles)
                {
                    if (newSpecies && (msgFile.mName.Contains("dlp_whitelist_monsname") || msgFile.mName.Contains("ss_monsname")))
                    {
                        string srcLabelName = "MONSNAME_" + srcMonsNo.ToString("D3");
                        string dstLabelName = "MONSNAME_" + dstMonsNo.ToString("D3");
                        LabelData srcLabelData = msgFile.labelDatas.Find(mf => mf.labelName == srcLabelName);
                        LabelData newLabelData = (LabelData)srcLabelData.Clone();
                        newLabelData.labelName = dstLabelName;
                        newLabelData.labelIndex = dstMonsNo;
                        newLabelData.arrayIndex = newLabelData.labelIndex;
                        newLabelData.wordDatas[0].str = speciesName;

                        if (dstMonsNo < msgFile.labelDatas.Count)
                            msgFile.labelDatas[dstMonsNo] = newLabelData;
                        else
                            msgFile.labelDatas.Add(newLabelData);
                    }

                    if (newSpecies && msgFile.mName.Contains("dp_pokedex_diamond"))
                    {
                        string srcLabelName = "DP_pokedex_diamond_" + srcMonsNo.ToString("D3");
                        string dstLabelName = "DP_pokedex_diamond_" + dstMonsNo.ToString("D3");
                        LabelData srcLabelData = msgFile.labelDatas.Find(mf => mf.labelName == srcLabelName);
                        LabelData newLabelData = (LabelData)srcLabelData.Clone();
                        newLabelData.labelName = dstLabelName;
                        newLabelData.labelIndex = dstMonsNo;
                        newLabelData.arrayIndex = newLabelData.labelIndex;

                        msgFile.labelDatas.Add(newLabelData);
                    }

                    if (newSpecies && msgFile.mName.Contains("dp_pokedex_pearl"))
                    {
                        string srcLabelName = "DP_pokedex_pearl_" + srcMonsNo.ToString("D3");
                        string dstLabelName = "DP_pokedex_pearl_" + dstMonsNo.ToString("D3");
                        LabelData srcLabelData = msgFile.labelDatas.Find(mf => mf.labelName == srcLabelName);
                        LabelData newLabelData = (LabelData)srcLabelData.Clone();
                        newLabelData.labelName = dstLabelName;
                        newLabelData.labelIndex = dstMonsNo;
                        newLabelData.arrayIndex = newLabelData.labelIndex;

                        msgFile.labelDatas.Add(newLabelData);
                    }

                    if (newSpecies && msgFile.mName.Contains("ss_zkn_type"))
                    {
                        string srcLabelName = "ZKN_TYPE_" + srcMonsNo.ToString("D3");
                        string dstLabelName = "ZKN_TYPE_" + dstMonsNo.ToString("D3");
                        LabelData srcLabelData = msgFile.labelDatas.Find(mf => mf.labelName == srcLabelName);
                        LabelData newLabelData = (LabelData)srcLabelData.Clone();
                        newLabelData.labelName = dstLabelName;
                        newLabelData.labelIndex = dstMonsNo;
                        newLabelData.arrayIndex = newLabelData.labelIndex;

                        msgFile.labelDatas.Add(newLabelData);
                    }

                    if (msgFile.mName.Contains("ss_zkn_form"))
                    {
                        LabelData baseLabelData = null;
                        foreach (LabelData labelData in msgFile.labelDatas)
                        {
                            string baseLabelName = string.Format("ZKN_FORM_{0}_{1}", srcMonsNo.ToString("D3"), srcFormNo.ToString("D3"));
                            if (labelData.labelName == baseLabelName)
                            {
                                baseLabelData = labelData;
                            }
                        }
                        LabelData newLabelData = (LabelData) baseLabelData.Clone();
                        newLabelData.labelName = string.Format("ZKN_FORM_{0}_{1}", dstMonsNo.ToString("D3"), dstFormNo.ToString("D3"));
                        newLabelData.labelIndex = gameData.GetPokemon(dstMonsNo, dstFormNo).personalID;
                        newLabelData.arrayIndex = newLabelData.labelIndex;
                        newLabelData.wordDatas[0].str = formName;

                        msgFile.labelDatas.Insert(newLabelData.arrayIndex, newLabelData);
                    }

                    if (msgFile.mName.Contains("ss_zkn_height"))
                    {
                        LabelData baseLabelData = null;
                        foreach (LabelData labelData in msgFile.labelDatas)
                        {
                            string baseLabelName = string.Format("ZKN_HEIGHT_{0}_{1}", srcMonsNo.ToString("D3"), srcFormNo.ToString("D3"));
                            if (labelData.labelName == baseLabelName)
                            {
                                baseLabelData = labelData;
                            }
                        }
                        LabelData newLabelData = (LabelData)baseLabelData.Clone();
                        newLabelData.labelName = string.Format("ZKN_HEIGHT_{0}_{1}", dstMonsNo.ToString("D3"), dstFormNo.ToString("D3"));
                        newLabelData.labelIndex = gameData.GetPokemon(dstMonsNo, dstFormNo).personalID;
                        newLabelData.arrayIndex = newLabelData.labelIndex;

                        msgFile.labelDatas.Insert(newLabelData.arrayIndex, newLabelData);
                    }

                    if (msgFile.mName.Contains("ss_zkn_weight"))
                    {
                        LabelData baseLabelData = null;
                        foreach (LabelData labelData in msgFile.labelDatas)
                        {
                            string baseLabelName = string.Format("ZKN_WEIGHT_{0}_{1}", srcMonsNo.ToString("D3"), srcFormNo.ToString("D3"));
                            if (labelData.labelName == baseLabelName)
                            {
                                baseLabelData = labelData;
                            }
                        }
                        LabelData newLabelData = (LabelData)baseLabelData.Clone();
                        newLabelData.labelName = string.Format("ZKN_WEIGHT_{0}_{1}", dstMonsNo.ToString("D3"), dstFormNo.ToString("D3"));
                        newLabelData.labelIndex = gameData.GetPokemon(dstMonsNo, dstFormNo).personalID;
                        newLabelData.arrayIndex = newLabelData.labelIndex;

                        msgFile.labelDatas.Insert(newLabelData.arrayIndex, newLabelData);
                    }
                }
            }
        }

        public void UpdatePokemonInfo(List<(int, int)> uniqueIDs, out List<(string, string)> assetBundleNames)
        {
            assetBundleNames = new();

            foreach ((int, int) uniqueIDPair in uniqueIDs)
            {
                Masterdatas.PokemonInfoCatalog srcPIC = gameData.pokemonInfos.Find(pic => pic.UniqueID == uniqueIDPair.Item1);
                
                Masterdatas.PokemonInfoCatalog dstPIC = (Masterdatas.PokemonInfoCatalog)srcPIC.Clone();
                gameData.pokemonInfos.Add(dstPIC);
                dstPIC.No = uniqueIDPair.Item2 / 10000;
                dstPIC.MonsNo = dstPIC.No;
                dstPIC.FormNo = uniqueIDPair.Item2 % 10000 / 100;
                dstPIC.UniqueID = uniqueIDPair.Item2;

                if (assetBundleNames.Any(p => p.Item1 == srcPIC.AssetBundleName))
                    dstPIC.AssetBundleName = assetBundleNames.Find(p => p.Item1 == srcPIC.AssetBundleName).Item2;
                else
                {
                    dstPIC.AssetBundleName = GenAssetBundleName(uniqueIDPair.Item2, srcPIC.AssetBundleName.Length, true);
                    assetBundleNames.Add((srcPIC.AssetBundleName, dstPIC.AssetBundleName));
                }
            }
        }

        private static string GenAssetBundleName(string oldFileName, int newLength) =>
            GenAssetBundleName(int.Parse(oldFileName.Replace("pm", "").Replace("_", "")), newLength);

        private static string GenAssetBundleName(int uniqueID, int length, bool adjustFormID = false)
        {
            //I've developed a strong distaste for this naming scheme lately. 
            if (adjustFormID)
                uniqueID += 1100;
            return length switch
            {
                9 => "pm" + (uniqueID / 10000).ToString("D4") +
                "_" + (uniqueID / 100 % 100).ToString("D2"),
                12 => "pm" + (uniqueID / 10000).ToString("D4") +
                "_" + (uniqueID / 100 % 100).ToString("D2") +
                "_" + (uniqueID % 100).ToString("D2"),
                _ => throw new NotImplementedException("Assetbundle file name of length " + length + " unsupported."),
            };
        }

        public void UpdateMotionTimingData(List<(int src, int dst)> uniqueIDs)
        {
            foreach ((int src, int dst) in uniqueIDs)
            {
                int srcMonsNo = src / 10000;
                int srcFormNo = src / 100 % 100;
                int srcSex = src / 10 % 10;
                int dstMonsNo = dst / 10000;
                int dstFormNo = dst / 100 % 100;
                int dstSex = dst / 10 % 10;
                if (gameData.motionTimingData.Any(o => o.MonsNo == dstMonsNo && o.FormNo == dstFormNo && o.Sex == dstSex))
                    continue;
                BattleMasterdatas.MotionTimingData baseMotionTimingData = null;
                foreach (BattleMasterdatas.MotionTimingData motionTimingData in gameData.motionTimingData)
                {
                    if (motionTimingData.MonsNo == srcMonsNo && motionTimingData.FormNo == srcFormNo && motionTimingData.Sex == srcSex)
                    {
                        baseMotionTimingData = motionTimingData;
                        break;
                    }
                }

                BattleMasterdatas.MotionTimingData newMotionTimingData = (BattleMasterdatas.MotionTimingData)baseMotionTimingData.Clone();
                newMotionTimingData.MonsNo = dstMonsNo;
                newMotionTimingData.FormNo = dstFormNo;
                newMotionTimingData.Sex = dstSex;
                gameData.motionTimingData.Add(newMotionTimingData);
            }
        }
        public void UpdateAddPersonalTable(int srcMonsNo, int dstMonsNo, int srcFormNo, int dstFormNo)
        {
            PersonalMasterdatas.AddPersonalTable baseAddPersonalTable = null;
            foreach (PersonalMasterdatas.AddPersonalTable addPersonalTable in gameData.addPersonalTables)
            {
                if (addPersonalTable.monsno == srcMonsNo && addPersonalTable.formno == srcFormNo)
                {
                    baseAddPersonalTable = addPersonalTable;
                    break;
                }
            }

            PersonalMasterdatas.AddPersonalTable newAddPersonalTable = (PersonalMasterdatas.AddPersonalTable)baseAddPersonalTable.Clone();
            newAddPersonalTable.monsno = (ushort) dstMonsNo;
            newAddPersonalTable.formno = (ushort) dstFormNo;
            gameData.addPersonalTables.Add(newAddPersonalTable);
        }

        public void UpdateUIMasterdatas(List<(int, int)> uniqueIDs,
            out Dictionary<string, string> menuSprites,
            out Dictionary<string, string> largeSprites,
            out Dictionary<string, string> dpSprites)
        {
            menuSprites = new();
            largeSprites = new();
            dpSprites = new();
            foreach ((int, int) uniqueIDPair in uniqueIDs)
            {
                int srcUniqueID = uniqueIDPair.Item1;
                int dstUniqueID = uniqueIDPair.Item2;

                UIMasterdatas.PokemonIcon pokemonIcon = gameData.uiPokemonIcon.Find(o => o.uniqueID == srcUniqueID);
                UIMasterdatas.PokemonIcon newPokemonIcon = (UIMasterdatas.PokemonIcon)pokemonIcon.Clone();
                newPokemonIcon.uniqueID = dstUniqueID;
                string menuSprite = pokemonIcon.assetName;
                string largeSprite = pokemonIcon.assetNameLarge;
                string dpSprite = pokemonIcon.assetNameDP;
                if (!menuSprites.ContainsKey(menuSprite))
                    menuSprites[menuSprite] = "pm" + (dstUniqueID / 10000).ToString("D4") + "_" +
                        (dstUniqueID / 100 % 100).ToString("D2") + "_" + (dstUniqueID / 10 % 10).ToString("D2") + "_" +
                        (dstUniqueID % 10).ToString("D2");
                if (!largeSprites.ContainsKey(largeSprite))
                    largeSprites[largeSprite] = "pm" + (dstUniqueID / 10000).ToString("D4") + "_" +
                        (dstUniqueID / 100 % 100).ToString("D2") + "_" + (dstUniqueID / 10 % 10).ToString("D2") + "_" +
                        (dstUniqueID % 10).ToString("D2") + "_l";
                if (!dpSprites.ContainsKey(dpSprite))
                    dpSprites[dpSprite] = "pm" + (dstUniqueID / 10000).ToString("D4") + "_" +
                        (dstUniqueID / 100 % 100).ToString("D2") + "_" + (dstUniqueID / 10 % 10).ToString("D2") + "_" +
                        (dstUniqueID % 10).ToString("D2") + "_dp";
                newPokemonIcon.assetName = newPokemonIcon.assetName.Replace(menuSprite, menuSprites[menuSprite]);
                newPokemonIcon.assetBundleName = newPokemonIcon.assetBundleName.Replace(menuSprite, menuSprites[menuSprite]);
                newPokemonIcon.assetNameLarge = newPokemonIcon.assetNameLarge.Replace(largeSprite, largeSprites[largeSprite]);
                newPokemonIcon.assetBundleNameLarge = newPokemonIcon.assetBundleNameLarge.Replace(largeSprite, largeSprites[largeSprite]);
                newPokemonIcon.assetNameDP = newPokemonIcon.assetNameDP.Replace(dpSprite, dpSprites[dpSprite]);
                newPokemonIcon.assetBundleNameDP = newPokemonIcon.assetBundleNameDP.Replace(dpSprite, dpSprites[dpSprite]);
                gameData.uiPokemonIcon.Add(newPokemonIcon);

                UIMasterdatas.AshiatoIcon ashiatoIcon = gameData.uiAshiatoIcon.Find(o => o.uniqueID == srcUniqueID);
                UIMasterdatas.AshiatoIcon newAshiatoIcon = (UIMasterdatas.AshiatoIcon)ashiatoIcon.Clone();
                newAshiatoIcon.uniqueID = dstUniqueID;
                gameData.uiAshiatoIcon.Add(newAshiatoIcon);

                UIMasterdatas.PokemonVoice pokemonVoice = gameData.uiPokemonVoice.Find(o => o.uniqueID == srcUniqueID);
                UIMasterdatas.PokemonVoice newPokemonVoice = (UIMasterdatas.PokemonVoice)pokemonVoice.Clone();
                if (uniqueIDPair.Item1 / 10000 != 25 && uniqueIDPair.Item1 / 10000 != 133)
                    newPokemonVoice.wwiseEvent = GetWwiseEvents(dstUniqueID).First();
                newPokemonVoice.uniqueID = dstUniqueID;
                gameData.uiPokemonVoice.Add(newPokemonVoice);

                UIMasterdatas.ZukanDisplay zukanDisplay = gameData.uiZukanDisplay.Find(o => o.uniqueID == srcUniqueID);
                UIMasterdatas.ZukanDisplay newZukanDisplay = (UIMasterdatas.ZukanDisplay)zukanDisplay.Clone();
                newZukanDisplay.uniqueID = dstUniqueID;
                gameData.uiZukanDisplay.Add(newZukanDisplay);

                UIMasterdatas.ZukanCompareHeight zukanCompareHeight = gameData.uiZukanCompareHeights.Find(o => o.uniqueID == srcUniqueID);
                UIMasterdatas.ZukanCompareHeight newZukanCompareHeight = (UIMasterdatas.ZukanCompareHeight)zukanCompareHeight.Clone();
                newZukanCompareHeight.uniqueID = dstUniqueID;
                gameData.uiZukanCompareHeights.Add(newZukanCompareHeight);

                if (gameData.uiSearchPokeIconSex[0].monsNo == dstUniqueID / 10000)
                {
                    gameData.uiSearchPokeIconSex[0].monsNo++;
                    UIMasterdatas.SearchPokeIconSex searchPokeIconSex = gameData.uiSearchPokeIconSex.Find(o => o.monsNo == srcUniqueID / 10000);
                    UIMasterdatas.SearchPokeIconSex newSearchPokeIconSex = (UIMasterdatas.SearchPokeIconSex)searchPokeIconSex.Clone();
                    newSearchPokeIconSex.monsNo = dstUniqueID / 10000;
                    gameData.uiSearchPokeIconSex.Add(newSearchPokeIconSex);
                }
            }
        }

        private static List<string> GetWwiseEvents(int uniqueID)
        {
            List<string> events = new();
            string[] prefixes = new string[]
            {
                "PLAY_PV", "PLAY_PV_BTL", "PLAY_PV_EV"
            };
            foreach (string p in prefixes)
                for (int i = 0; i < 5; i++)
                    events.Add(p + "_" + (uniqueID / 10000).ToString("D3") + "_" +
                        (uniqueID / 100 % 100).ToString("D2") + "_" + i.ToString("D2"));
            return events;
        }

        private void DuplicateAssetBundles(Dictionary<string, string> assetBundlePaths)
        {
            CloneMode c = CloneMode.Unk;
            foreach (KeyValuePair<string, string> item in assetBundlePaths)
                c = DuplicateAssetBundle(item.Key, item.Value, c);
        }

        private enum CloneMode
        {
            Unk, Mod, Dump
        }

        private CloneMode DuplicateAssetBundle(string srcPath, string dstPath, CloneMode c)
        {
            string baseDirectory = Environment.CurrentDirectory + "\\" + FileManager.outputModName + "\\romfs\\Data\\StreamingAssets\\AssetAssistant\\";
            string newCAB = GenCABName();
            string refPM = Path.GetFileNameWithoutExtension(dstPath);

            List<AssetsReplacer> ars = new();
            AssetsManager am = fileManager.GetAssetsManager();
            am.updateAfterLoad = true;
            BundleFileInstance bfi = null;
            switch (c)
            {
                case CloneMode.Unk:
                    bfi = fileManager.TryGetPokemonBundleFileInstance(dstPath.Replace('/', '\\'));
                    if (bfi == null)
                    {
                        bfi = fileManager.GetPokemonBundleFileInstance(srcPath.Replace('/', '\\'));
                        c = CloneMode.Dump;
                    }
                    else
                    {
                        srcPath = dstPath;
                        c = CloneMode.Mod;
                    }
                    break;
                case CloneMode.Mod:
                    srcPath = dstPath;
                    bfi = fileManager.GetPokemonBundleFileInstance(srcPath.Replace('/', '\\'));
                    break;
                case CloneMode.Dump:
                    bfi = fileManager.GetPokemonBundleFileInstance(srcPath.Replace('/', '\\'));
                    break;
            }

            bfi.name = ReplacePM(bfi.name, refPM);

            AssetsFileInstance afi = am.LoadAssetsFileFromBundle(bfi, 0);
            
            string oldCAB = afi.name.Replace("CAB-", "");
            afi.name = afi.name.Replace(oldCAB, newCAB);
            CABNames[oldCAB] = newCAB;
            
            AssetBundleDirectoryInfo06[] dirInf = bfi.file.bundleInf6.dirInf;
            // afi.table.assetFileInfo
            foreach (AssetBundleDirectoryInfo06 iDirInf in dirInf)
            {
                string dirInfName = iDirInf.name;
                if (dirInfName.Contains(".resS"))
                {
                    iDirInf.name = dirInfName.Replace(oldCAB, newCAB);
                }
            }

            for (int i = 0; i < afi.file.dependencies.dependencyCount; i++)
            {
                string assetPath = afi.file.dependencies.dependencies[i].assetPath;
                foreach (string cabName in CABNames.Keys)
                {
                    assetPath = assetPath.Replace(cabName, CABNames[cabName]);
                }
                afi.file.dependencies.dependencies[i].assetPath = assetPath;
            }
            
            List<AssetTypeValueField> texture2Ds = afi.table.GetAssetsOfType((int)AssetClassID.Texture2D).Select(afie => am.GetTypeInstance(afi, afie).GetBaseField()).ToList();

            AssetTypeValueField texture2DField;
            for (int i = 0; i < texture2Ds.Count; i++)
            {
                texture2DField = texture2Ds[i];

                string m_Name = texture2DField["m_Name"].value.AsString();
                AssetFileInfoEx afie = afi.table.GetAssetInfo(m_Name, (int)AssetClassID.Texture2D);

                string m_StreamDataPath = texture2DField["m_StreamData"].children[2].value.AsString();
                m_Name = ReplacePM(m_Name, refPM);
                m_StreamDataPath = m_StreamDataPath.Replace(oldCAB, newCAB);
                texture2DField["m_Name"].GetValue().Set(m_Name);
                texture2DField["m_StreamData"].children[2].GetValue().Set(m_StreamDataPath);

                byte[] b = texture2DField.WriteToByteArray();
                AssetsReplacerFromMemory arfm = new(0, afie.index, (int)afie.curFileType, AssetHelper.GetScriptIndex(afi.file, afie), b);
                ars.Add(arfm);
            }
            
            List<AssetTypeValueField> gameObjects = afi.table.GetAssetsOfType((int)AssetClassID.GameObject).Select(afie => am.GetTypeInstance(afi, afie).GetBaseField()).ToList();
            AssetTypeValueField gameObject;

            for (int i = 0; i < gameObjects.Count; i++)
            {
                gameObject = gameObjects[i];

                string m_Name = gameObject["m_Name"].value.AsString();
                AssetFileInfoEx afie = afi.table.GetAssetInfo(m_Name, (int)AssetClassID.GameObject);

                m_Name = ReplacePM(m_Name, refPM);
                gameObject["m_Name"].GetValue().Set(m_Name);

                byte[] b = gameObject.WriteToByteArray();
                AssetsReplacerFromMemory arfm = new(0, afie.index, (int)afie.curFileType, AssetHelper.GetScriptIndex(afi.file, afie), b);
                ars.Add(arfm);
            }
            /*
            List<AssetTypeValueField> materials = afi.table.GetAssetsOfType((int)AssetClassID.Material).Select(afie => am.GetTypeInstance(afi, afie).GetBaseField()).ToList();
            AssetTypeValueField material;

            for (int i = 0; i < materials.Count; i++)
            {
                material = materials[i];

                string m_Name = material["m_Name"].value.AsString();
                AssetFileInfoEx afie = afi.table.GetAssetInfo(m_Name, (int)AssetClassID.Material);

                m_Name = ReplacePM(m_Name, refPM);
                material["m_Name"].GetValue().Set(m_Name);

                byte[] b = material.WriteToByteArray();
                AssetsReplacerFromMemory arfm = new(0, afie.index, (int)afie.curFileType, AssetHelper.GetScriptIndex(afi.file, afie), b);
                ars.Add(arfm);
            }

            List<AssetTypeValueField> meshes = afi.table.GetAssetsOfType((int)AssetClassID.Mesh).Select(afie => am.GetTypeInstance(afi, afie).GetBaseField()).ToList();
            AssetTypeValueField mesh;

            for (int i = 0; i < meshes.Count; i++)
            {
                mesh = meshes[i];

                string m_Name = mesh["m_Name"].value.AsString();
                AssetFileInfoEx afie = afi.table.GetAssetInfo(m_Name, (int)AssetClassID.Mesh);

                m_Name = ReplacePM(m_Name, refPM);
                mesh["m_Name"].GetValue().Set(m_Name);

                byte[] b = mesh.WriteToByteArray();
                AssetsReplacerFromMemory arfm = new(0, afie.index, (int)afie.curFileType, AssetHelper.GetScriptIndex(afi.file, afie), b);
                ars.Add(arfm);
            }


            List<AssetTypeValueField> animationClips = afi.table.GetAssetsOfType((int)AssetClassID.AnimationClip).Select(afie => am.GetTypeInstance(afi, afie).GetBaseField()).ToList();

            AssetTypeValueField animationClip;
            for (int i = 0; i < animationClips.Count; i++)
            {
                animationClip = animationClips[i];

                string m_Name = animationClip["m_Name"].value.AsString();
                AssetFileInfoEx afie = afi.table.GetAssetInfo(m_Name, (int)AssetClassID.AnimationClip);

                m_Name = ReplacePM(m_Name, refPM);
                animationClip["m_Name"].GetValue().Set(m_Name);

                byte[] b = animationClip.WriteToByteArray();
                AssetsReplacerFromMemory arfm = new(0, afie.index, (int)afie.curFileType, AssetHelper.GetScriptIndex(afi.file, afie), b);
                ars.Add(arfm);
            }
            */
            List<AssetTypeValueField> assetBundles = afi.table.GetAssetsOfType((int)AssetClassID.AssetBundle).Select(afie => am.GetTypeInstance(afi, afie).GetBaseField()).ToList();
            AssetTypeValueField assetBundle;
            for (int i = 0; i < assetBundles.Count; i++)
            {
                assetBundle = assetBundles[i];

                string m_Name = assetBundle["m_Name"].value.AsString();
                string m_AssetBundleName = assetBundle["m_AssetBundleName"].value.AsString();
                AssetFileInfoEx afie = afi.table.GetAssetInfo(m_Name, (int)AssetClassID.AssetBundle);

                m_Name = ReplacePM(m_Name, refPM);
                m_AssetBundleName = ReplacePM(m_AssetBundleName, refPM);
                assetBundle["m_Name"].GetValue().Set(m_Name);
                assetBundle["m_AssetBundleName"].GetValue().Set(m_AssetBundleName);

                AssetTypeValueField m_Dependencies = assetBundle["m_Dependencies"][0];
                for (int j = 0; j < m_Dependencies.childrenCount; j++)
                {
                    AssetTypeValueField entry = m_Dependencies.children[j];
                    string key = entry.value.AsString();
                    key = ReplacePM(key, refPM);
                    entry.GetValue().Set(key);
                }

                AssetTypeValueField m_Container = assetBundle["m_Container"][0];

                for (int j = 0; j < m_Container.childrenCount; j++)
                {
                    AssetTypeValueField entry = m_Container.children[j];
                    string key = entry.children[0].value.AsString();
                    key = ReplacePM(key, refPM);
                    entry.children[0].GetValue().Set(key);
                }

                byte[] b = assetBundle.WriteToByteArray();
                AssetsReplacerFromMemory arfm = new(0, afie.index, (int)afie.curFileType, AssetHelper.GetScriptIndex(afi.file, afie), b);
                ars.Add(arfm);
            }
            
            // TODO: Update AABBData in PokemonPrefabInfo
            // TODO: Update FieldPokemonEntity
            
            am.UpdateDependencies(afi);
            
            if (c == CloneMode.Mod)
                srcPath = dstPath;

            fileManager.MakeTempBundle("romfs\\Data\\StreamingAssets\\AssetAssistant\\Pokemon Database\\" + srcPath.Replace('/', '\\'),
                "romfs\\Data\\StreamingAssets\\AssetAssistant\\Pokemon Database\\" + dstPath.Replace('/', '\\'), ars, "CAB-" + newCAB);

            return c;
        }
    }
}